<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN" "JATS-archivearticle1-mathml3.dtd"> 
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName A++V2.4.dtd?><?SourceDTD.Version 2.4?><?ConverterInfo.XSLTName springer2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">Sci Rep</journal-id><journal-id journal-id-type="iso-abbrev">Sci Rep</journal-id><journal-title-group><journal-title>Scientific Reports</journal-title></journal-title-group><issn pub-type="epub">2045-2322</issn><publisher><publisher-name>Nature Publishing Group UK</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">6987180</article-id><article-id pub-id-type="publisher-id">58021</article-id><article-id pub-id-type="doi">10.1038/s41598-020-58021-7</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Internal short circuit detection in Li-ion batteries using supervised machine learning</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Naha</surname><given-names>Arunava</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Khandelwal</surname><given-names>Ashish</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Agarwal</surname><given-names>Samarth</given-names></name><address><email>agarwal.samarth@gmail.com</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Tagade</surname><given-names>Piyush</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Hariharan</surname><given-names>Krishnan S.</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Kaushik</surname><given-names>Anshul</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Yadu</surname><given-names>Ankit</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Kolake</surname><given-names>Subramanya Mayya</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Han</surname><given-names>Seongho</given-names></name><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Oh</surname><given-names>Bookeun</given-names></name><xref ref-type="aff" rid="Aff2">2</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1767 2380</institution-id><institution-id institution-id-type="GRID">grid.465065.4</institution-id><institution>Mobile Battery Research Lab, Samsung R&#x00026;D Institute India - Bangalore (SRIB), #2870, Phoenix Building, Bagmane Constellation Business Park, Outer ring road, Doddanekundi circle, Marathahalli Post, </institution></institution-wrap>Bangalore, 560037 India </aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 1945 5898</institution-id><institution-id institution-id-type="GRID">grid.419666.a</institution-id><institution>Advanced Battery Lab, Mobile Communication Business Division, SAMSUNG ELECTRONICS Co., </institution></institution-wrap>Gyeonggi-do, 16677 Korea </aff></contrib-group><pub-date pub-type="epub"><day>28</day><month>1</month><year>2020</year></pub-date><pub-date pub-type="pmc-release"><day>28</day><month>1</month><year>2020</year></pub-date><pub-date pub-type="collection"><year>2020</year></pub-date><volume>10</volume><elocation-id>1301</elocation-id><history><date date-type="received"><day>17</day><month>9</month><year>2019</year></date><date date-type="accepted"><day>2</day><month>1</month><year>2020</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2020</copyright-statement><license license-type="OpenAccess"><license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article&#x02019;s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article&#x02019;s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p></license></permissions><abstract id="Abs1"><p id="Par1">With the proliferation of Li-ion batteries in smart phones, safety is the main concern and an on-line detection of battery faults is much wanting. Internal short circuit is a very critical issue that is often ascribed to be a cause of many accidents involving Li-ion batteries. A novel method that can detect the Internal short circuit in real time based on an advanced machine leaning approach, is proposed. Based on an equivalent electric circuit model, a set of features encompassing the physics of Li-ion cell with short circuit fault are identified and extracted from each charge-discharge cycle. The training feature set is generated with and without an external short-circuit resistance across the battery terminals. To emulate a real user scenario, internal short is induced by mechanical abuse. The testing feature set is generated from the battery charge-discharge data before and after the abuse. A random forest classifier is trained with the training feature set. The fault detection accuracy for the testing dataset is found to be more than 97%. The proposed algorithm does not interfere with the normal usage of the device, and the trained model can be implemented in any device for online fault detection.</p></abstract><kwd-group kwd-group-type="npg-subject"><title>Subject terms</title><kwd>Chemical engineering</kwd><kwd>Computational science</kwd></kwd-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; The Author(s) 2020</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1" sec-type="introduction"><title>Introduction</title><p id="Par2">Nowadays, smart phones, electric vehicles and most of consumer electronics use Li-ion batteries (LiBs) due to their high energy density, long cycle life and extended calendar life. Due to the wide spread applicability, LiBs are subjected to mechanical abuse of varying intensities. As illustrated in Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>, mechanical abuse to the battery may lead to internal short circuit (ISC) due to the damage of the insulating separator, deflection of the electrodes, etc.<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. Such ISC causes internal heating and further damage of the battery, that may cause smoke, fire or an explosion. Thermal runaway of the battery is a serious threat to user safety.<fig id="Fig1"><label>Figure 1</label><caption><p>Mechanical abuse to thermal runaway mechanism.</p></caption><graphic xlink:href="41598_2020_58021_Fig1_HTML" id="d29e262"/></fig></p><p id="Par3">The effects of the mechanical abuse on the LiB and the mechanisms of thermal runaway have been studied extensively in the literature by modelling and experiments. The models have been developed by combining the mechanical, electrochemical, and thermal behaviour of the LiBs under various types of mechanical abuses<sup><xref ref-type="bibr" rid="CR2">2</xref>&#x02013;<xref ref-type="bibr" rid="CR9">9</xref></sup>. Most of the reported models have been validated with experimental data. The dynamic and quasi-static mechanical abuse tests studied by several researchers are indentation test<sup><xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR10">10</xref>,<xref ref-type="bibr" rid="CR11">11</xref></sup>, punch test<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>, nail penetration test<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>, pinch-torsion test<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>, compressive test<sup><xref ref-type="bibr" rid="CR14">14</xref>&#x02013;<xref ref-type="bibr" rid="CR16">16</xref></sup>, drop test or impact test<sup><xref ref-type="bibr" rid="CR17">17</xref></sup>, etc. The mechanism of ISC development from the pinch and pinch-torsion types of mechanical abuse has been modelled in<sup><xref ref-type="bibr" rid="CR18">18</xref></sup> and stated that pinch-torsion is more effective than the pure pinch in puncturing the separator and creating ISC. Fracturing of the separator due to the ground impact of an electric vehicle battery which leads to ISC formation has been modelled using global finite element<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>. The crush test has been performed<sup><xref ref-type="bibr" rid="CR20">20</xref></sup> on the whole battery pack of four cells and the short circuit current has been measured. The short circuit resistance has been estimated from the measured current. A mechanical model of cylindrical LiB has been developed<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> for the vehicle crash simulation. Impact test has been performed using a drop tower on fully charged batteries<sup><xref ref-type="bibr" rid="CR17">17</xref></sup>. The effect of loading and the impact location on the probability of short circuit and thermal run away have been studied in detail. A detailed review of the existing experimental and model based methods to study the effect of mechanical abuse on the different form factors of Li-ion batteries is available<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>.</p><p id="Par4">The stress-strain distribution under abusive conditions and the relationship with the ISC formation have been reported<sup><xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR23">23</xref></sup>. The mechanical properties and the failure mechanism of the different battery components such as the electrodes<sup><xref ref-type="bibr" rid="CR24">24</xref>&#x02013;<xref ref-type="bibr" rid="CR26">26</xref></sup> and the separators<sup><xref ref-type="bibr" rid="CR24">24</xref>,<xref ref-type="bibr" rid="CR27">27</xref></sup> have also been studied individually. The mechanical properties of the overall battery pack has been explored<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>. The effect of design parameters such as the porosity and thickness of the electrodes and separators on the ISC caused by mechanical abuse has been investigated<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>. Researchers have reported two different failure modes of the separators<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>, and concluded that one of them causes thermal runaway and the other one may not exhibit such severe effect. Experiments have been performed<sup><xref ref-type="bibr" rid="CR29">29</xref></sup> using dummy pouch cells without the conductive salts to determine the short circuit resistance value under different compressive loads. Few possible ways to prevent or reduce the effect of the thermal runaway followed by the mechanical abuse have been discussed<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>. The effect of state of charge (SOC) levels on the consequence of the mechanical abuse has been researched<sup><xref ref-type="bibr" rid="CR23">23</xref></sup> using simulation and experimentation. The researchers also suggested few thermal run away detection strategies based on force-displacement, voltage-temperature<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>, stress-strain, SOC<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>, over-discharge<sup><xref ref-type="bibr" rid="CR32">32</xref></sup> etc. A quantitative definition of the state of safety (SOS) has been provided as the inverse of safety<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>.</p><p id="Par5">The aforementioned literature on the mechanical abuse of LiBs leading to ISC formation and the subsequent thermal runway is quite insightful. It helps to improve the battery safety design and the assessment of hazard under the real world mechanical abuses. However, the detection of ISC followed by the mechanical abuse is also an important issue for the battery and user safety. Many effective methods have been reported in the literature for ISC detection using a range of statistical measures, estimation techniques, observer designs, etc. The correlations between the different voltage curves of various cells present in a battery pack have been used to detect the short circuits<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>. The external short circuit has been identified in<sup><xref ref-type="bibr" rid="CR35">35</xref></sup> using the Gaussian classifier on the features extracted by maximum likelihood estimator from the battery current and voltage data. Different observers, such as extended Kalman filter (EKF)<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>, Luenberger observer<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>, etc. have been employed to generate the residual signal from the measured data for the ISC detection. In another approach, the researchers have estimated various informative parameters from the measured battery current, voltage, and temperature data and compared them with their normal values for the ISC detection in<sup><xref ref-type="bibr" rid="CR38">38</xref>&#x02013;<xref ref-type="bibr" rid="CR41">41</xref></sup>. There are few patents covering the topic of LiB ISC detection. The methodologies reported in the patents check for the battery temperature level<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>, voltage values at different SOC levels<sup><xref ref-type="bibr" rid="CR43">43</xref></sup>, instantaneous change in battery voltage<sup><xref ref-type="bibr" rid="CR44">44</xref></sup> and current<sup><xref ref-type="bibr" rid="CR45">45</xref></sup>, battery resting voltage change over a long period of time<sup><xref ref-type="bibr" rid="CR46">46</xref>,<xref ref-type="bibr" rid="CR47">47</xref></sup>, etc.</p><p id="Par6">Amongst all the batteries undergoing mechanical abuse, not all necessarily result in to ISC. We have also observed the same from our several experiments of dropping the batteries. It is also observed that some features revert to healthy regime upon cycling and some appear in faulty regime. This may be due to the non-uniform deformation of electrode layers of jelly rolled pouch cell. The real life ISC due to non-rigorous quality control practiced during manufacturing process is akin to the feature response shown by the dropped battery. Hence, classification of healthy and faulty battery using simple statistical classification based on single feature does not yield good accuracy. Therefore, in this work we have developed a robust supervised learning method for robust classification of healthy and faulty batteries using random forest (RF) based classifier. RF uses an ensemble of trees of slightly different structures for classifications. The use of multiple trees makes RF more robust compared to any single classifier<sup><xref ref-type="bibr" rid="CR48">48</xref></sup> and the accuracy is also high<sup><xref ref-type="bibr" rid="CR49">49</xref></sup>. Compared to other classifiers like Artificial Neural Networks (ANN), nearest neighbour, Support Vector Machine (SVM), RF is a linear classifier and showed better results in our analysis. Further, scaling of the features is not an issue. The computational complexity of RF is low compare to few other popular classifiers<sup><xref ref-type="bibr" rid="CR50">50</xref></sup> and it serves as a lightweight online algorithm that does not interfere with normal usage. RF has been applied successfully to various classification problems such as sleep stages classifications from the electroencephalography (EEG) data<sup><xref ref-type="bibr" rid="CR51">51</xref></sup>, bearing faults identification from the vibration data<sup><xref ref-type="bibr" rid="CR52">52</xref></sup>, facial expression detection from video data<sup><xref ref-type="bibr" rid="CR53">53</xref></sup>, crops type classification from the hyper spectral images<sup><xref ref-type="bibr" rid="CR54">54</xref></sup>, lung vessel segmentation<sup><xref ref-type="bibr" rid="CR55">55</xref></sup> from computed tomography (CT) image, etc.</p><p id="Par7">The literature is rich with the methods of ISC detection in the LiBs. However, the following reasons limit the applicability of the available methods for the detection of mechanical abused induced ISC in the smart phone&#x02019;s LiB. <list list-type="order"><list-item><p id="Par8">Some of the reported methods are only applicable to the battery packs where multiple cells of similar specification are present<sup><xref ref-type="bibr" rid="CR34">34</xref>,<xref ref-type="bibr" rid="CR56">56</xref></sup>.</p></list-item><list-item><p id="Par9">In the smart phones, the battery temperature<sup><xref ref-type="bibr" rid="CR40">40</xref>,<xref ref-type="bibr" rid="CR42">42</xref>,<xref ref-type="bibr" rid="CR57">57</xref></sup> at the appropriate spot may not be available. In addition, the temperature rise happens just before the thermal runaway, therefore early warning may not be possible.</p></list-item><list-item><p id="Par10">In case of the smart phones, the normal device operation cannot be hampered by any special charge-discharge profiles<sup><xref ref-type="bibr" rid="CR46">46</xref>,<xref ref-type="bibr" rid="CR47">47</xref>,<xref ref-type="bibr" rid="CR58">58</xref>,<xref ref-type="bibr" rid="CR59">59</xref></sup>.</p></list-item></list></p><p id="Par11">In this paper, an algorithm has been developed for online detection of the mechanical abuse induced ISC in the smart phone&#x02019;s LiB using the previously mentioned RF classifier. We have also built an Android application to log the battery charge-discharge data inside the smart phones. The recorded data then transferred to the computer for further processing. First, a set of features have been extracted from the training dataset of battery current and voltage for classification purpose. The training dataset is composed of healthy and ISC battery data. The ISC condition has been emulated by connecting external short circuit resistances across the battery terminal, and the battery has been connected to the phone for regular charge-discharge. The RF classifier has been trained using the features extracted from the training dataset. The testing dataset comprises of healthy and abused (with ISC) battery data. The LiBs have been abused by dropping them on hard surface. This allows the test conditions to be random, which simulates real life situations. The abused batteries with ISC and the healthy batteries have been classified with the trained RF model. In the proposed methodology, the training will be performed offline using the healthy and ISC (emulated by external short circuit resistances) battery data, and then the trained classifier will be ported in the mobile device for online detection of ISC induced by the mechanical abuses or any other reasons.</p></sec><sec id="Sec2" sec-type="results"><title>Results and Discussion</title><p id="Par12">The following equivalent circuit models (ECM)<sup><xref ref-type="bibr" rid="CR60">60</xref></sup> are used for healthy (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2a</xref>) and faulty (ISC) (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2b</xref>) LiBs.<fig id="Fig2"><label>Figure 2</label><caption><p>Battery electrical equivalent circuit for (<bold>a</bold>) Healthy battery, (<bold>b</bold>) Faulty battery and (<bold>c</bold>) SOC vs OCV curve during discharge.</p></caption><graphic xlink:href="41598_2020_58021_Fig2_HTML" id="d29e565"/></fig></p><p id="Par13"><italic>V</italic><sub><italic>t</italic></sub> and <italic>I</italic><sub><italic>t</italic></sub> are the terminal voltage and current respectively. <italic>V</italic><sub><italic>o</italic><italic>c</italic><italic>v</italic></sub> is the open circuit voltage (OCV) of the battery. <italic>R</italic><sub><italic>i</italic></sub> is the internal resistance of the battery which is a function of SOC. <italic>R</italic><sub><italic>s</italic><italic>c</italic></sub> is the short circuit resistance and <italic>I</italic><sub><italic>s</italic><italic>c</italic></sub> is the leakage current or the short circuit current. The relationship of OCV with the terminal voltage and current for healthy&#x000a0;<xref rid="Equ1" ref-type="">1</xref> and ISC&#x000a0;<xref rid="Equ2" ref-type="">2</xref> cases are as follows <disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${V}_{t}(k)={V}_{ocv}(k)+{R}_{i}(SOC){I}_{t}(k)$$\end{document}</tex-math><mml:math id="M2" display="block"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="41598_2020_58021_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${V}_{t}(k)={V}_{ocv}(k)+{R}_{i}(SOC){I}_{i}(k)$$\end{document}</tex-math><mml:math id="M4" display="block"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="41598_2020_58021_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula> where under healthy case, <italic>I</italic><sub><italic>i</italic></sub>(<italic>k</italic>)&#x000a0;=&#x000a0;<italic>I</italic><sub><italic>t</italic></sub>(<italic>k</italic>), and ISC case, <italic>I</italic><sub><italic>i</italic></sub>(<italic>k</italic>)&#x000a0;=&#x000a0;<italic>I</italic><sub><italic>t</italic></sub>(<italic>k</italic>)&#x000a0;&#x02212;&#x000a0;<italic>I</italic><sub><italic>s</italic><italic>c</italic></sub>(<italic>k</italic>) and <inline-formula id="IEq1"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${I}_{sc}=\frac{{V}_{t}(k)}{{R}_{sc}}$$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="41598_2020_58021_Article_IEq1.gif"/></alternatives></inline-formula>.</p><p id="Par14">A set of features are used to encompass the effect of ISC on the battery voltage and current. In the subsequent subsections, the features and the reason for individual choices are discussed.</p><sec id="Sec3"><title>End of charge SOC (<italic>S</italic><italic>O</italic><italic>C</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub>)</title><p id="Par15">The SOC is estimated as follows: <disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$SOC(k+1)=SOC(k)+\frac{{I}_{t}(k){T}_{s}}{{C}_{max}}$$\end{document}</tex-math><mml:math id="M8" display="block"><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41598_2020_58021_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula> where <italic>T</italic><sub><italic>s</italic></sub> is the sampling time, and <italic>C</italic><sub><italic>m</italic><italic>a</italic><italic>x</italic></sub> is the maximum capacity of the battery.</p><p id="Par16">In the case of ISC, SOC at the end of charging will be more than the normal case because of the leakage current (<italic>I</italic><sub><italic>s</italic><italic>c</italic></sub>).</p></sec><sec id="Sec4"><title>OCV at low SOC level (<italic>V</italic><sub><italic>c</italic><italic>m</italic><italic>i</italic><italic>n</italic></sub>)</title><p id="Par17">The OCV (<italic>V</italic><sub><italic>c</italic><italic>m</italic><italic>i</italic><italic>n</italic></sub>)&#x000a0;<xref rid="Equ4" ref-type="">4</xref> at <italic>p</italic>% user SOC during the discharging phase is taken as a feature. In the case of ISC fault, the actual SOC will be lower than the estimated user SOC from the terminal current because of the presence of the leakage current <italic>I</italic><sub><italic>s</italic><italic>c</italic></sub>. The difference will increase with time as the actual SOC reduces. Since OCV is a monotonic function of SOC, <italic>V</italic><sub><italic>c</italic><italic>m</italic><italic>i</italic><italic>n</italic><italic>f</italic></sub> will be lower than <italic>V</italic><sub><italic>c</italic><italic>m</italic><italic>i</italic><italic>n</italic><italic>h</italic></sub>, where the subscripts <italic>f</italic> and <italic>h</italic> denote faulty and healthy cases respectively.<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${V}_{cmin}={V}_{t}(at\,p \% \,user\,SOC)+{R}_{i}(at\,p \% \,user\,SOC){I}_{t}(at\,p \% \,user\,SOC)$$\end{document}</tex-math><mml:math id="M10" display="block"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mspace width="0.25em"/><mml:mi>p</mml:mi><mml:mi>%</mml:mi><mml:mspace width="0.25em"/><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.25em"/><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mspace width="0.25em"/><mml:mi>p</mml:mi><mml:mi>%</mml:mi><mml:mspace width="0.25em"/><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.25em"/><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mspace width="0.25em"/><mml:mi>p</mml:mi><mml:mi>%</mml:mi><mml:mspace width="0.25em"/><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.25em"/><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="41598_2020_58021_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p></sec><sec id="Sec5"><title>CV time (<italic>T</italic><sub><italic>c</italic><italic>v</italic></sub>)</title><p id="Par18">Typically, battery charging is performed using the protocol of constant current (CC) or constant power (CP) charging followed by constant voltage (CV) charging<sup><xref ref-type="bibr" rid="CR61">61</xref>,<xref ref-type="bibr" rid="CR62">62</xref></sup>. The time taken to complete the constant voltage (CV) phase (<italic>T</italic><sub><italic>c</italic><italic>v</italic></sub>) of charging is also a useful feature for ISC detection. Since a portion of the charging current always flows through the short circuit path, the faulty battery takes more time to complete the CV phase, <italic>T</italic><sub><italic>c</italic><italic>v</italic><italic>f</italic></sub>&#x000a0;&#x0003e;&#x000a0;<italic>T</italic><sub><italic>c</italic><italic>v</italic><italic>h</italic></sub>. The CC or CP charging time also increases under ISC fault. However, the percentage of charging current flowing through the short circuit path during CC or CP charging is much smaller compared to the CV phase. The difference between the charging time for the healthy and faulty cases is more in the CV phase then in the CC phase. Therefore, the effect of ISC is more prominent in the CV phase.</p></sec><sec id="Sec6"><title>Energy loss (<italic>E</italic><sub><italic>L</italic></sub>)</title><p id="Par19">In the case of ISC fault, the total energy input to the battery during the charging phase will be more and the total energy output during the discharging phase will be less compared to the healthy case. The continuous loss of energy through the short circuit resistance <inline-formula id="IEq2"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left(\Sigma \frac{{V}^{2}(k)}{{R}_{sc}}{T}_{s}\right)$$\end{document}</tex-math><mml:math id="M12"><mml:mo>(</mml:mo><mml:mi mathvariant="normal">&#x003a3;</mml:mi><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="41598_2020_58021_Article_IEq2.gif"/></alternatives></inline-formula> causes this difference. Therefore, the difference of energy between the charge and discharge phase is taken as a feature&#x000a0;<xref rid="Equ5" ref-type="">5</xref>, <italic>E</italic><sub><italic>L</italic><italic>f</italic></sub>&#x000a0;&#x0003e;&#x000a0;<italic>E</italic><sub><italic>L</italic><italic>h</italic></sub>.<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${E}_{L}=\sum _{charging}{V}_{t}(k){I}_{t}(k){T}_{s}-\sum _{discharging}{V}_{t}(k){I}_{t}(k){T}_{s}$$\end{document}</tex-math><mml:math id="M14" display="block"><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:munder><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="41598_2020_58021_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p></sec><sec id="Sec7"><title>Slope of OCV near the end of discharge (<italic>S</italic><italic>l</italic><italic>o</italic><italic>p</italic><italic>e</italic><sub><italic>o</italic><italic>c</italic><italic>v</italic></sub>)</title><p id="Par20">The <italic>S</italic><italic>l</italic><italic>o</italic><italic>p</italic><italic>e</italic><sub><italic>o</italic><italic>c</italic><italic>v</italic></sub> feature is evaluated as <disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Slop{e}_{ocv}=\frac{{V}_{ocv}(m)-{V}_{ocv}(n)}{SOC(m)-SOC(n)}$$\end{document}</tex-math><mml:math id="M16" display="block"><mml:mi>S</mml:mi><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>p</mml:mi><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41598_2020_58021_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>where the <italic>m</italic>-point correspond to the end of discharge and the <italic>n</italic>-point is identified in such a way that, <italic>S</italic><italic>O</italic><italic>C</italic>(<italic>m</italic>)&#x000a0;&#x02212;&#x000a0;<italic>S</italic><italic>O</italic><italic>C</italic>(<italic>n</italic>)&#x000a0;=&#x000a0;5%. As discussed earlier, the actual SOC remains lower than the estimated SOC under ISC fault. The lower SOC during ISC pushes the operating point towards the high slope region of the SOC-OCV curve (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2c</xref>). Therefore, <italic>S</italic><italic>l</italic><italic>o</italic><italic>p</italic><italic>e</italic><sub><italic>o</italic><italic>c</italic><italic>v</italic><italic>f</italic></sub>&#x000a0;&#x0003e;&#x000a0;<italic>S</italic><italic>l</italic><italic>o</italic><italic>p</italic><italic>e</italic><sub><italic>o</italic><italic>c</italic><italic>v</italic><italic>h</italic></sub>.</p></sec><sec id="Sec8"><title><italic>S</italic><italic>O</italic><italic>C</italic> vs. <italic>V</italic><sub><italic>o</italic><italic>c</italic><italic>v</italic></sub> slope (<italic>a</italic><sub>1</sub>)</title><p id="Par21">The OCV will drop faster with respect to the estimated SOC during the discharge because of the continuous leakage under ISC fault. Therefore, a fifth order polynomial is fitted&#x000a0;<xref rid="Equ7" ref-type="">7</xref> between <italic>V</italic><sub><italic>o</italic><italic>c</italic><italic>v</italic></sub> and estimated <italic>S</italic><italic>O</italic><italic>C</italic>. The first order slope parameter <italic>a</italic><sub>1</sub> is taken as a feature. A fifth order polynomial was found to give a good fit with data. Higher order polynomials gave an ill-conditioned system to solve for the polynomial co-efficients.<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${V}_{ocv}(k)={a}_{0}+{a}_{1}.SOC(k)+{a}_{2}.SO{C}^{2}(k)+{a}_{3}.SO{C}^{3}(k)+{a}_{4}.SO{C}^{4}(k)+{a}_{5}.SO{C}^{5}(k)$$\end{document}</tex-math><mml:math id="M18" display="block"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="41598_2020_58021_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p></sec><sec id="Sec9"><title>Internal resistance</title><p id="Par22">Battery internal resistance (<italic>R</italic><sub><italic>i</italic></sub>) is an important parameter to detect ISC. <italic>R</italic><sub><italic>i</italic></sub> is evaluated for the existing implementation as, <disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${R}_{i}(SOC(k))=\frac{\left|{V}_{t}(k)-{V}_{ocv}(k)\right|}{{I}_{t}(k)}.$$\end{document}</tex-math><mml:math id="M20" display="block"><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mfenced close="&#x02223;" open="&#x02223;" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:math><graphic xlink:href="41598_2020_58021_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par23"><italic>V</italic><sub><italic>o</italic><italic>c</italic><italic>v</italic></sub> values are gathered up from the SOC-OCV relationship. The estimated <italic>R</italic><sub><italic>i</italic></sub> under normal&#x000a0;<xref rid="Equ9" ref-type="">9</xref> and ISC&#x000a0;<xref rid="Equ10" ref-type="">10</xref> conditions during the charging phase will be as follows. The subscript <italic>c</italic> is used to indicate charging phase. It is clear from&#x000a0;<xref rid="Equ9" ref-type="">9</xref> and <xref rid="Equ10" ref-type="">10</xref> that <inline-formula id="IEq3"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widehat{R}}_{ifc} &#x0003c; {\widehat{R}}_{ihc}$$\end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>&#x0003c;</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>h</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2020_58021_Article_IEq3.gif"/></alternatives></inline-formula>, <disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widehat{R}}_{ihc}(SOC(k))=\frac{{V}_{t}(k)-{V}_{ocv}(k)}{{I}_{t}(k)}={R}_{i}(SOC(k))$$\end{document}</tex-math><mml:math id="M24" display="block"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>h</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="41598_2020_58021_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widehat{R}}_{ifc}(SOC(k))=\frac{{V}_{t}(k)-{V}_{ocv}(k)}{{I}_{t}(k)}={R}_{i}(SOC(k))-\frac{{R}_{i}(SOC(k))}{{R}_{sc}}\frac{{V}_{t}(k)}{{I}_{t}(k)}$$\end{document}</tex-math><mml:math id="M26" display="block"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41598_2020_58021_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par24">The estimated <italic>R</italic><sub><italic>i</italic></sub> under normal&#x000a0;<xref rid="Equ11" ref-type="">11</xref> and ISC&#x000a0;<xref rid="Equ12" ref-type="">12</xref> conditions during the discharging phase will be as follows. The subscript <italic>d</italic> is used to indicate discharging phase. It is clear from&#x000a0;<xref rid="Equ11" ref-type="">11</xref> and <xref rid="Equ12" ref-type="">12</xref> that <inline-formula id="IEq4"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widehat{R}}_{ifd} &#x0003e; {\widehat{R}}_{ihd}$$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>&#x0003e;</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>h</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2020_58021_Article_IEq4.gif"/></alternatives></inline-formula>.<disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widehat{R}}_{ihd}(SOC(k))=\frac{{V}_{ocv}(k)-{V}_{t}(k)}{{I}_{t}(k)}={R}_{i}(SOC(k))$$\end{document}</tex-math><mml:math id="M30" display="block"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>h</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="41598_2020_58021_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ12"><label>12</label><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widehat{R}}_{ifd}(SOC(k))=\frac{{V}_{ocv}(k)-{V}_{t}(k)}{{I}_{t}(k)}={R}_{i}(SOC(k))+\frac{{R}_{i}(SOC(k))}{{R}_{sc}}\frac{{V}_{t}(k)}{{I}_{t}(k)}$$\end{document}</tex-math><mml:math id="M32" display="block"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41598_2020_58021_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par25">Under the ISC fault, the estimated resistance decreases during charging and increases during discharging compared to the healthy case. Hence the difference between the estimated charging and discharging resistances will reduce in the case of the ISC fault, i.e. (\<xref rid="Equ10" ref-type="">10</xref>&#x02013;<xref rid="Equ12" ref-type="">12</xref>&#x02223;) will reduce compared to (&#x02223;<xref rid="Equ9" ref-type="">9</xref>&#x02013;<xref rid="Equ11" ref-type="">11</xref>&#x02223;). Another observation can be made from&#x000a0;<xref rid="Equ10" ref-type="">10</xref> and <xref rid="Equ12" ref-type="">12</xref>, that under the ISC fault, the change in the estimated <inline-formula id="IEq5"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widehat{R}}_{i}$$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2020_58021_Article_IEq5.gif"/></alternatives></inline-formula> will be more during the discharging phase compared to the charging phase. The effect of ISC is prominent in the discharging phase estimated resistance because the magnitude of current remains smaller compared to the CC or CP charging current for smart phone applications. From the two observations, the following two features are extracted from the estimated internal resistance.</p><p id="Par26">
<list list-type="order"><list-item><p id="Par27"><italic>&#x00394;</italic><italic>R</italic>&#x000a0;=&#x000a0; (estimated resistance at the end of charging) &#x000a0;&#x02212;&#x000a0; (estimated resistance at the start of discharging)</p></list-item><list-item><p id="Par28"><italic>m</italic><italic>e</italic><italic>a</italic><italic>n</italic><italic>R</italic>&#x000a0;=&#x000a0; mean of the estimated resistance for the window of SOC 0.3 to 0.8 during discharging</p></list-item></list>
</p><p id="Par29">It must be pointed out that using various methods in literature for the direct estimation of <italic>R</italic><sub><italic>s</italic><italic>c</italic></sub> a very high variance in estimates was found and an alternative was needed. Instead the estimation of <inline-formula id="IEq6"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widehat{R}}_{i}$$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2020_58021_Article_IEq6.gif"/></alternatives></inline-formula> was done using a Kalman Filter and did not require the estimation of <italic>R</italic><sub><italic>s</italic><italic>c</italic></sub>. A process noise with zero mean and covariance = 10<sup>&#x02212;3</sup> and an observation noise with zero mean and covariance = 25 has been assumed.</p><p id="Par30">The block diagram of the proposed methodology is shown in Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>. The method is explained in a systematic way in the following steps.<fig id="Fig3"><label>Figure 3</label><caption><p>Block diagram of the proposed methodology.</p></caption><graphic xlink:href="41598_2020_58021_Fig3_HTML" id="d29e2988"/></fig></p><p id="Par31">
<list list-type="order"><list-item><p id="Par32">Data generation for training and testing purpose.</p></list-item><list-item><p id="Par33">A set of 8 features as are extracted from the battery current and voltage data during standard charging and discharging.</p></list-item><list-item><p id="Par34">Random Forest (RF) classifier is trained with the training set features.</p></list-item><list-item><p id="Par35">Testing set features are used to test the performance of the trained classifier for the identification of healthy and abused batteries with ISC.</p></list-item></list>
</p><p id="Par36">For the training dataset, optimum values need to be found for the number of trees (<italic>N</italic><sub><italic>t</italic></sub>) and the number of features (<italic>m</italic><italic>a</italic><italic>x</italic>_<italic>f</italic><italic>e</italic><italic>a</italic><italic>t</italic><italic>u</italic><italic>r</italic><italic>e</italic><italic>s</italic>) in the RF problem. As explained further in the Methods section, a grid search is performed over the feasible range of <italic>N</italic><sub><italic>t</italic></sub> and <italic>m</italic><italic>a</italic><italic>x</italic>_<italic>f</italic><italic>e</italic><italic>a</italic><italic>t</italic><italic>u</italic><italic>r</italic><italic>e</italic><italic>s</italic> to find their suitable values for the training dataset. Separate grid searches are performed for different end of discharge SOC levels and the derived <italic>N</italic><sub><italic>t</italic></sub> and <italic>m</italic><italic>a</italic><italic>x</italic>_<italic>f</italic><italic>e</italic><italic>a</italic><italic>t</italic><italic>u</italic><italic>r</italic><italic>e</italic><italic>s</italic> values change accordingly. For example, when the end of discharge SOC level is 5%, the values of <italic>N</italic><sub><italic>t</italic></sub>&#x000a0;=&#x000a0;15 and <inline-formula id="IEq7"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$max\,\_features=\sqrt{total\_number\_of\_\,features}$$\end{document}</tex-math><mml:math id="M38"><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mspace width="0.25em"/><mml:mstyle mathvariant="normal"><mml:mo>_</mml:mo></mml:mstyle><mml:mi>f</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mstyle mathvariant="normal"><mml:mo>_</mml:mo></mml:mstyle><mml:mi>n</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mstyle mathvariant="normal"><mml:mo>_</mml:mo></mml:mstyle><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mstyle mathvariant="normal"><mml:mo>_</mml:mo></mml:mstyle><mml:mspace width="0.25em"/><mml:mi>f</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:msqrt></mml:math><inline-graphic xlink:href="41598_2020_58021_Article_IEq7.gif"/></alternatives></inline-formula> are derived.</p><p id="Par37">The importance of different features for the healthy and faulty classifications is shown in Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>. The results are generated using the training dataset (healthy and external short cases) for different end of discharge SOC. The importance of features changes depending on the end of discharge SOC value. After analysing the sub-figures in Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>, we can conclude that <italic>V</italic><sub><italic>c</italic><italic>m</italic><italic>i</italic><italic>n</italic></sub>, <italic>S</italic><italic>l</italic><italic>o</italic><italic>p</italic><italic>e</italic><sub><italic>o</italic><italic>c</italic><italic>v</italic></sub>, <italic>a</italic><sub>1</sub>, <italic>m</italic><italic>e</italic><italic>a</italic><italic>n</italic><italic>R</italic>, and <italic>E</italic><sub><italic>L</italic></sub> are the most important features in classifying the healthy and faulty classes from the training dataset. However, the other features also contribute to certain extents. It has been verified that accuracy falls down if the number of features is reduced. The Gini index is used to find the quality of a split in the Python package scikit-learn. The mean decrease in impurity approach is applied to the fraction of samples a feature contributes, to create a normalized estimate of the importance of that feature. In generating these features a fixed value of <inline-formula id="IEq8"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widehat{R}}_{i}=0.1\Omega $$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn><mml:mi mathvariant="normal">&#x003a9;</mml:mi></mml:math><inline-graphic xlink:href="41598_2020_58021_Article_IEq8.gif"/></alternatives></inline-formula> has been used.<fig id="Fig4"><label>Figure 4</label><caption><p>Feature importance matrix for different SOC cutoff limits, (<bold>a</bold>) SOC cutoff 5%, (<bold>b</bold>) SOC cutoff 15%.</p></caption><graphic xlink:href="41598_2020_58021_Fig4_HTML" id="d29e3312"/></fig></p><p id="Par38">The RF classifier has been trained using the healthy and ISC battery (with external short circuit resistance) data for different end of discharge SOC levels. The parameters derived from the grid search are used for the final training. Users may not always discharge the battery to a very low SOC value under the practical cases. Therefore, one of the trained classifiers can be used to predict the battery health from the test data depending on the percentage of partial discharge. The performance of the classifier for the training data for a SOC cut-off of 5% is found to be Normally Normal (NiN) = 100%, Faulty in Fault (FiF) = 99.66%, False Alarm = 0.0% and a Miss detection = 0.34%. The training performance is not affected much by different SOC cut-offs. Total 290 faulty cycles of different magnitudes of external short (150&#x000a0;&#x003a9; to 500&#x000a0;&#x003a9;) and 53 healthy cycles are used to train the RF classifier and generate the confusion matrices.</p><p id="Par39">The trained RF models are used to classify the abused batteries with ISC from the healthy population. 129 faulty (ISC induced by mechanical abuse) and 148 healthy charge-discharge cycles from 5 different batteries are used for testing. Testing is also performed for different end of discharge SOC levels similar to the training dataset. The receiver operating characteristics (ROC) curves for different level of partial discharging (end of discharge SOC) are shown in Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>. All ROCs have area under the curve(AUC) close to 1 which means the trained RF models can also classify the abused batteries with ISC faults with high accuracy. The performance of the classifiers degrade minutely with the increase of end of discharge SOC levels. Confusion matrix represents the performance of a classifier in the tabular form. Rows of the matrix specify the actual class and columns specify the predicted class. For the two-class classification problem, the first, second, third and fourth quadrants of the 2&#x000a0;&#x000d7;&#x000a0;2 matrix represent false positive (FP), true negative (TN), false negative (FN) and true positive (TP) numbers respectively. The confusion matrices for the operating points marked on the ROC curves are shown in Table&#x000a0;<xref rid="Tab1" ref-type="table">1</xref>. The confusion matrices also infer that the proposed method has good detection accuracy with low miss-detection and false alarm rates for different end of discharge SOC levels.<fig id="Fig5"><label>Figure 5</label><caption><p>ROC curves for testing data for different end of discharge SOC levels (<bold>a</bold>) Full view (<bold>b</bold>) Expanded view.</p></caption><graphic xlink:href="41598_2020_58021_Fig5_HTML" id="d29e3338"/></fig><table-wrap id="Tab1"><label>Table 1</label><caption><p>Confusion matrix for testing dataset for different SOC cut-off limit.</p></caption><table frame="hsides" rules="groups"><tbody><tr><td/><td/><td/><td>NiN&#x000a0;=&#x000a0;100%</td><td/><td/><td/><td>NiN&#x000a0;=&#x000a0;97.97%</td></tr><tr><td><bold>SOC&#x000a0;=&#x000a0;5</bold>%</td><td>Faulty</td><td>Healthy</td><td>FiF&#x000a0;=&#x000a0;98.45%</td><td><bold>SOC&#x000a0;=&#x000a0;15</bold>%</td><td>Faulty</td><td>Healthy</td><td>FiF&#x000a0;=&#x000a0;97.67%</td></tr><tr><td>Faulty</td><td>TN&#x000a0;=&#x000a0;127</td><td>FP&#x000a0;=&#x000a0;2</td><td>False Alarm&#x000a0;=&#x000a0;0.0%</td><td>Faulty</td><td>TN&#x000a0;=&#x000a0;126</td><td>FP&#x000a0;=&#x000a0;3</td><td>False Alarm&#x000a0;=&#x000a0;2.03%</td></tr><tr><td>Healthy</td><td>FN&#x000a0;=&#x000a0;0</td><td>TP&#x000a0;=&#x000a0;148</td><td>Miss-detection&#x000a0;=&#x000a0;1.55</td><td>Healthy</td><td>FN&#x000a0;=&#x000a0;3</td><td>TP&#x000a0;=&#x000a0;145</td><td>Miss-detection&#x000a0;=&#x000a0;2.33%</td></tr><tr><td/><td/><td/><td>NiN&#x000a0;=&#x000a0;97.97%</td><td/><td/><td/><td>NiN&#x000a0;=&#x000a0;93.92%</td></tr><tr><td><bold>SOC&#x000a0;=&#x000a0;30</bold>%</td><td>Faulty</td><td>Healthy</td><td>FiF&#x000a0;=&#x000a0;97.67%</td><td><bold>SOC&#x000a0;=&#x000a0;50</bold>%</td><td>Faulty</td><td>Healthy</td><td>FiF&#x000a0;=&#x000a0;97.67%</td></tr><tr><td>Faulty</td><td>TN&#x000a0;=&#x000a0;126</td><td>FP&#x000a0;=&#x000a0;3</td><td>False Alarm&#x000a0;=&#x000a0;2.03%</td><td>Faulty</td><td>TN&#x000a0;=&#x000a0;126</td><td>FP&#x000a0;=&#x000a0;3</td><td>False Alarm&#x000a0;=&#x000a0;6.08%</td></tr><tr><td>Healthy</td><td>FN&#x000a0;=&#x000a0;3</td><td>TP&#x000a0;=&#x000a0;145</td><td>Miss-detection&#x000a0;=&#x000a0;2.33</td><td>Healthy</td><td>FN&#x000a0;=&#x000a0;9</td><td>TP&#x000a0;=&#x000a0;139</td><td>Miss-detection&#x000a0;=&#x000a0;2.33%</td></tr></tbody></table></table-wrap></p><p id="Par40">The performance of RF was compared with different classifier and the results are shown in Table&#x000a0;<xref rid="Tab2" ref-type="table">2</xref>. The same data was used to train and test all classifiers. It can be seen that the value for NiN is the highest for RF.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Performance of different classifiers.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Classifier</th><th align="left">RF</th><th align="left">ANN</th><th align="left">SVM</th></tr></thead><tbody><tr><td>NiN</td><td>100.0</td><td>97.97</td><td>94.59</td></tr><tr><td>FiF</td><td>98.45</td><td>100.0</td><td>87.60</td></tr></tbody></table></table-wrap></p></sec></sec><sec id="Sec10" sec-type="conclusion"><title>Conclusion</title><p id="Par41">A novel methodology with high accuracy is proposed for online detection of mechanical abused induced ISCs in the smart phone batteries. The proposed methodology is tested successfully with 100% normal in normal and 98.45% fault in fault accuracy for the complete discharge cases (end of discharge SOC = 5%). Advanced supervised machine learning is applied to learn about the healthy and faulty feature spaces from the healthy and pure short data. The trained models are then applied to detect the mechanical abuse induced ISC faults in the smart phone batteries. The batteries are abused by dropping them from 4ft height on the hard surface. Three batteries are used for generating training data and five batteries are used for testing purpose. Training and testing subjects are completely different from each other. The proposed algorithm has been tested in a computer using the data logged in the smart phones using the developed Android APK. In the proposed methodology, the training of the classifier can be performed in the same way using a PC, and then the trained model will be transferred to the smart phones in the form of APK or as embedded code for the power management integrated circuit (PMIC) for online detection of ISC. The proposed methodology can also be applied after certain modifications to detect ISCs in the Li-ion batteries used in the various systems such as EVs, aircrafts, etc. induced by mechanical abuses or other factors. The benefits of the methodology are that it can be used to detect a pre-existing fault and detect ISC from the first cycle itself. There are no restrictions on the SOC range of cycling of the battery and the algorithm is capable of detecting ISC for any partial charging cycle. However a continuous range of charge or discharge data is required for the algorithm to work. This limitation is planned to be addressed in future studies. Finally, given that 8 different features are combined to predict faults makes the methodology more robust and reliable. All this is done keeping in mind that the methodology is simple enough and does not add a significant overhead to device operation.</p></sec><sec id="Sec11"><title>Methods</title><sec id="Sec12"><title>Training and Testing data generation</title><p id="Par42">An Android application has been developed to log the battery current and voltage from the PMIC while charging and discharging the smart phone. Li-ion rechargeable smartphone batteries with 3 Ah capacity and 3.85V nominal voltage have been used. The charging scheme used is the normal constant current (CC) charging at 0.7<italic>C</italic> rate followed by the constant voltage (CV) charging. The display and the flashlight of the phone are kept on and the processor is loaded with some dummy programs to discharge the battery.</p><p id="Par43">The Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6a</xref> illustrates the different types of battery data generated for this research and their utilization. The train data set contains both the normal and the ISC battery (with external resistance) data from three different batteries for several charge-discharge cycles. External short circuit resistances of various values are connected across the battery terminals when the battery is also connected to the phone to generate the ISC data. The short circuit resistance value is changed in steps from 500&#x000a0;&#x003a9; to 150&#x000a0;&#x003a9;. The schematics of the electrical circuit of such arrangements is shown in Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6b</xref>, and the photograph of the setup is shown in Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6c</xref>.<fig id="Fig6"><label>Figure 6</label><caption><p>Training and testing battery data generation arrangements. (<bold>a</bold>) Types of data and usages. (<bold>b</bold>) Schematic diagram of the ISC test setup. (<bold>c</bold>) Experimental setup of ISC test (<bold>d</bold>) Schematic diagram of the drop test (<bold>e</bold>) Dropped battery (<bold>f</bold>) Thermal image of dropped battery.</p></caption><graphic xlink:href="41598_2020_58021_Fig6_HTML" id="d29e3652"/></fig></p><p id="Par44">Testing is performed on the five different healthy and subsequently abused batteries to detect ISCs using the trained RF model. First, the healthy batteries are cycled in the devices using the developed application and the healthy data are logged. Then those batteries are abused by dropping them from 4<italic>f</italic><italic>t</italic> height on the hard surface with the protection circuit module (PCM) kept upside. A schematic diagram of the battery dropping arrangements is shown in Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6d</xref>. Figure&#x000a0;<xref rid="Fig6" ref-type="fig">6e</xref> shows a dropped battery with deformed corner due to the impact. Figure&#x000a0;<xref rid="Fig6" ref-type="fig">6f</xref> shows the thermal image of the dropped battery with the hotspot generated at the deformed location. The most likely mechanism of short here seems to be the physical deformation of the battery which leads to a conductive path between the electrodes. The abused batteries are then cycled in the devices and the testing data are logged. Batteries developing ISC due to drop is a probabilistic event. The batteries may not develop ISC even after the drop. Therefore, after the cycling, the dropped batteries are kept idle for three days at full charged condition and the OCVs are monitored. If the OCV drops more than or equal to 0.4<italic>V</italic> in three days, then those batteries are identified as faulty (ISC). Application of simple circuit theory on the battery electrical equivalent circuit (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2b</xref>) shows that the short circuit resistance for such cases will be less than 500<italic>&#x003a9;</italic>. If a battery does not develop ISC after the first drop, the same drop procedure is repeated until the battery becomes faulty or completely unusable.</p></sec><sec id="Sec13"><title>Random forest classifier</title><p id="Par45">The random forest (RF) algorithm was first introduced by Breiman in 2001<sup><xref ref-type="bibr" rid="CR50">50</xref></sup>. RF uses a set of tree structures with small differences for the classification and regression purpose. Application of ensemble of trees makes the RF more robust and less prone to over fitting compared to a single tree. The flowchart in Fig.&#x000a0;<xref rid="Fig7" ref-type="fig">7a</xref> illustrates the basic building blocks of the RF algorithm<sup><xref ref-type="bibr" rid="CR50">50</xref>,<xref ref-type="bibr" rid="CR63">63</xref></sup>.<fig id="Fig7"><label>Figure 7</label><caption><p>(<bold>a</bold>) Random Forest and (<bold>b</bold>) The five fold cross validation process.</p></caption><graphic xlink:href="41598_2020_58021_Fig7_HTML" id="d29e3712"/></fig></p><p id="Par46">The bootstrap sampling scheme used for RF implementation in this paper, divides the total training set of <italic>N</italic> samples into <italic>N</italic><sub><italic>t</italic></sub> groups of <italic>N</italic> samples. <italic>N</italic><sub><italic>t</italic></sub> is the number of trees present in the forest. Each group is formed by selecting samples randomly from the complete training set of <italic>N</italic> samples with replacements. Therefore, each group may contain multiple similar samples.</p><p id="Par47">The number of trees (<italic>N</italic><sub><italic>t</italic></sub>) in the forest and the number of features (<italic>m</italic><italic>a</italic><italic>x</italic>_<italic>f</italic><italic>e</italic><italic>a</italic><italic>t</italic><italic>u</italic><italic>r</italic><italic>e</italic><italic>s</italic>) used for splitting a node are the two most important parameters for the performance of the RF algorithm. Higher <italic>N</italic><sub><italic>t</italic></sub> gives better predictions at the cost of higher computational burden. <italic>m</italic><italic>a</italic><italic>x</italic>_<italic>f</italic><italic>e</italic><italic>a</italic><italic>t</italic><italic>u</italic><italic>r</italic><italic>e</italic><italic>s</italic> decides the randomness between the trees. Higher value of <italic>m</italic><italic>a</italic><italic>x</italic>_<italic>f</italic><italic>e</italic><italic>a</italic><italic>t</italic><italic>u</italic><italic>r</italic><italic>e</italic><italic>s</italic> gives nearly similar trees which may reduce robustness. Smaller value of <italic>m</italic><italic>a</italic><italic>x</italic>_<italic>f</italic><italic>e</italic><italic>a</italic><italic>t</italic><italic>u</italic><italic>r</italic><italic>e</italic><italic>s</italic> means deeper trees and increased computational burden. In the present implementation, the values of <italic>N</italic><sub><italic>t</italic></sub> and <italic>m</italic><italic>a</italic><italic>x</italic>_<italic>f</italic><italic>e</italic><italic>a</italic><italic>t</italic><italic>u</italic><italic>r</italic><italic>e</italic><italic>s</italic> are derived using the grid search among few suitable values.</p><p id="Par48">To predict a class from the test data, first, all the trees make independent predictions with some probability values attached to each predictions. The class with highest overall probability is selected as the final prediction of the RF algorithm. Since the training of this algorithm is done offline, the computational complexity is determined by the testing stage of the RF algorithm on the smart phone and is given by <italic>O</italic>(<italic>N</italic><sub><italic>t</italic></sub>.&#x000a0;<italic>D</italic>) where D is the depth of the trees.</p></sec><sec id="Sec14"><title>Implementation and performance evaluation</title><p id="Par49">The Python package scikit-learn is used for the RF implementation and performance evaluation. As discussed earlier, the performance of RF depends profoundly on the two important parameters, <italic>N</italic><sub><italic>t</italic></sub> and <italic>m</italic><italic>a</italic><italic>x</italic>_<italic>f</italic><italic>e</italic><italic>a</italic><italic>t</italic><italic>u</italic><italic>r</italic><italic>e</italic><italic>s</italic>. In the present implementation, <italic>N</italic><sub><italic>t</italic></sub> and <italic>m</italic><italic>a</italic><italic>x</italic>_<italic>f</italic><italic>e</italic><italic>a</italic><italic>t</italic><italic>u</italic><italic>r</italic><italic>e</italic><italic>s</italic> are derived by performing a grid search on the suitable range of values using the method <italic>gridsearchCV</italic> from the scikit-learn package. The performance for each set of parameters are evaluated by the five-fold cross validation (CVal), and the scores are evaluated as the AUC of the ROC curves. The values of <italic>N</italic><sub><italic>t</italic></sub> and <italic>m</italic><italic>a</italic><italic>x</italic>_<italic>f</italic><italic>e</italic><italic>a</italic><italic>t</italic><italic>u</italic><italic>r</italic><italic>e</italic><italic>s</italic> are derived using the healthy and ISC (with external resistance) data, and those values are used for the testing dataset of healthy and ISC (mechanically abused) battery data.</p><p id="Par50">In the five-fold CVal scheme, the entire dataset is divided into 5 equal sets by randomly selecting samples from the full set without replacements. Training is performed on each combination of four sets and testing is performed on the remaining set. Therefore, the training and testing are performed total five times. CVal method reduces the chances of over training. A schematic diagram is shown in Fig.&#x000a0;<xref rid="Fig7" ref-type="fig">7b</xref> to illustrate the CVal process.</p><p id="Par51">RF assigns a probability value between 0 and 1 for each data sample classification. The probability value is compared with a threshold value (by default 0.5). If the probability value is more than the threshold, the data sample is classified as positive class otherwise as negative class. ROC is the false positive rate (FPR)&#x000a0;<xref rid="Equ13" ref-type="">13</xref> vs. true positive rate (TPR)&#x000a0;<xref rid="Equ14" ref-type="">14</xref> curve for different threshold values. AUC of ROC varies between 0 and 1. AUC closer to 1 means better classification of the samples.<disp-formula id="Equ13"><label>13</label><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$FPR=\frac{FP}{FP+TN}$$\end{document}</tex-math><mml:math id="M42" display="block"><mml:mi>F</mml:mi><mml:mi>P</mml:mi><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>F</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>T</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41598_2020_58021_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ14"><label>14</label><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$TPR=\frac{TP}{TP+FN}$$\end{document}</tex-math><mml:math id="M44" display="block"><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41598_2020_58021_Article_Equ14.gif" position="anchor"/></alternatives></disp-formula></p></sec></sec></body><back><fn-group><fn><p><bold>Publisher&#x02019;s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></fn></fn-group><notes notes-type="author-contribution"><title>Author contributions</title><p>A.N. and A.Kh. conceived the idea and designed the detection framework. A.Y. wrote the code for on-device implementation. S.A., P.T. and K.S.H. helped in the preparation of the manuscript. A.Ka., S.M.K., S.H. and B.O. analysed the results. All authors discussed the results and commented on the manuscript at all stages.</p></notes><notes notes-type="COI-statement"><title>Competing interests</title><p id="Par52">The authors declare no competing interests.</p></notes><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1.</label><mixed-citation publication-type="other">Feng,&#x000a0; X.&#x000a0; <italic>et al</italic>.&#x000a0; Thermal runaway mechanism of lithium ion battery for electric vehicles: A review. <italic>Energy Storage Materials</italic> (2017).</mixed-citation></ref><ref id="CR2"><label>2.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>C</given-names></name><name><surname>Santhanagopalan</surname><given-names>S</given-names></name><name><surname>Sprague</surname><given-names>MA</given-names></name><name><surname>Pesaran</surname><given-names>AA</given-names></name></person-group><article-title>Coupled mechanical-electrical-thermal modeling for short-circuit prediction in a lithium-ion cell under mechanical abuse</article-title><source>Journal of Power Sources</source><year>2015</year><volume>290</volume><fpage>102</fpage><lpage>113</lpage><pub-id pub-id-type="doi">10.1016/j.jpowsour.2015.04.162</pub-id></element-citation></ref><ref id="CR3"><label>3.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>C</given-names></name><name><surname>Santhanagopalan</surname><given-names>S</given-names></name><name><surname>Sprague</surname><given-names>MA</given-names></name><name><surname>Pesaran</surname><given-names>AA</given-names></name></person-group><article-title>A representative-sandwich model for simultaneously coupled mechanical-electrical-thermal simulation of a lithium-ion cell under quasi-static indentation tests</article-title><source>Journal of Power Sources</source><year>2015</year><volume>298</volume><fpage>309</fpage><lpage>321</lpage><pub-id pub-id-type="doi">10.1016/j.jpowsour.2015.08.049</pub-id></element-citation></ref><ref id="CR4"><label>4.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marcicki</surname><given-names>J</given-names></name><etal/></person-group><article-title>A simulation framework for battery cell impact safety modeling using ls-dyna</article-title><source>Journal of The Electrochemical Society</source><year>2017</year><volume>164</volume><fpage>A6440</fpage><lpage>A6448</lpage><pub-id pub-id-type="doi">10.1149/2.0661701jes</pub-id></element-citation></ref><ref id="CR5"><label>5.</label><mixed-citation publication-type="other">Zhang,&#x000a0; C.,&#x000a0; Santhanagopalan,&#x000a0; S.,&#x000a0; Stock,&#x000a0; M.J.,&#x000a0; Brunhart-Lupo,&#x000a0; N.&#x000a0;&#x00026;&#x000a0; Gruchalla,&#x000a0; K.&#x000a0; Interpretation of simultaneous mechanical-electrical-thermal failure in a lithium-ion battery module: Preprint. Tech. Rep.,NREL (National Renewable Energy Laboratory (NREL), Golden, CO (United States)) (2016).</mixed-citation></ref><ref id="CR6"><label>6.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname><given-names>J</given-names></name><name><surname>Wu</surname><given-names>Y</given-names></name><name><surname>Yin</surname><given-names>S</given-names></name></person-group><article-title>Investigation of effects of design parameters on the internal short-circuit in cylindrical lithium-ion batteries</article-title><source>RSC Advances</source><year>2017</year><volume>7</volume><fpage>14360</fpage><lpage>14371</lpage><pub-id pub-id-type="doi">10.1039/C6RA27892B</pub-id></element-citation></ref><ref id="CR7"><label>7.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>B</given-names></name><name><surname>Zhao</surname><given-names>H</given-names></name><name><surname>Yu</surname><given-names>H</given-names></name><name><surname>Li</surname><given-names>J</given-names></name><name><surname>Xu</surname><given-names>J</given-names></name></person-group><article-title>Multiphysics computational framework for cylindrical lithium-ion batteries under mechanical abusive loading</article-title><source>Electrochimica Acta</source><year>2017</year><volume>256</volume><fpage>172</fpage><lpage>184</lpage><pub-id pub-id-type="doi">10.1016/j.electacta.2017.10.045</pub-id></element-citation></ref><ref id="CR8"><label>8.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>B</given-names></name><name><surname>Yin</surname><given-names>S</given-names></name><name><surname>Xu</surname><given-names>J</given-names></name></person-group><article-title>Integrated computation model of lithium-ion battery subject to nail penetration</article-title><source>Applied Energy</source><year>2016</year><volume>183</volume><fpage>278</fpage><lpage>289</lpage><pub-id pub-id-type="doi">10.1016/j.apenergy.2016.08.101</pub-id></element-citation></ref><ref id="CR9"><label>9.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>R</given-names></name><name><surname>Liu</surname><given-names>J</given-names></name><name><surname>Gu</surname><given-names>J</given-names></name></person-group><article-title>A comprehensive study on li-ion battery nail penetrations and the possible solutions</article-title><source>Energy</source><year>2017</year><volume>123</volume><fpage>392</fpage><lpage>401</lpage><pub-id pub-id-type="doi">10.1016/j.energy.2017.02.017</pub-id></element-citation></ref><ref id="CR10"><label>10.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kumar</surname><given-names>A</given-names></name><etal/></person-group><article-title>Communication&#x02014;indentation of li-ion pouch cell: Effect of material homogenization on prediction of internal short circuit</article-title><source>Journal of The Electrochemical Society</source><year>2016</year><volume>163</volume><fpage>A2494</fpage><lpage>A2496</lpage><pub-id pub-id-type="doi">10.1149/2.0151613jes</pub-id></element-citation></ref><ref id="CR11"><label>11.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luo</surname><given-names>H</given-names></name><name><surname>Xia</surname><given-names>Y</given-names></name><name><surname>Zhou</surname><given-names>Q</given-names></name></person-group><article-title>Mechanical damage in a lithium-ion pouch cell under indentation loads</article-title><source>Journal of Power Sources</source><year>2017</year><volume>357</volume><fpage>61</fpage><lpage>70</lpage><pub-id pub-id-type="doi">10.1016/j.jpowsour.2017.04.101</pub-id></element-citation></ref><ref id="CR12"><label>12.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>X</given-names></name><name><surname>Sahraei</surname><given-names>E</given-names></name><name><surname>Wang</surname><given-names>K</given-names></name></person-group><article-title>Li-ion battery separators, mechanical integrity and failure mechanisms leading to soft and hard internal shorts</article-title><source>Scientific reports</source><year>2016</year><volume>6</volume><fpage>32578</fpage><pub-id pub-id-type="doi">10.1038/srep32578</pub-id><?supplied-pmid 27581185?><pub-id pub-id-type="pmid">27581185</pub-id></element-citation></ref><ref id="CR13"><label>13.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vijayaraghavan</surname><given-names>V</given-names></name><name><surname>Garg</surname><given-names>A</given-names></name><name><surname>Gao</surname><given-names>L</given-names></name></person-group><article-title>Fracture mechanics modelling of lithium-ion batteries under pinch torsion test</article-title><source>Measurement</source><year>2018</year><volume>114</volume><fpage>382</fpage><lpage>389</lpage><pub-id pub-id-type="doi">10.1016/j.measurement.2017.10.008</pub-id></element-citation></ref><ref id="CR14"><label>14.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gilaki</surname><given-names>M</given-names></name><name><surname>Avdeev</surname><given-names>I</given-names></name></person-group><article-title>Impact modeling of cylindrical lithium-ion battery cells: a heterogeneous approach</article-title><source>Journal of Power Sources</source><year>2016</year><volume>328</volume><fpage>443</fpage><lpage>451</lpage><pub-id pub-id-type="doi">10.1016/j.jpowsour.2016.08.034</pub-id></element-citation></ref><ref id="CR15"><label>15.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhu</surname><given-names>J</given-names></name><name><surname>Zhang</surname><given-names>X</given-names></name><name><surname>Sahraei</surname><given-names>E</given-names></name><name><surname>Wierzbicki</surname><given-names>T</given-names></name></person-group><article-title>Deformation and failure mechanisms of 18650 battery cells under axial compression</article-title><source>Journal of Power Sources</source><year>2016</year><volume>336</volume><fpage>332</fpage><lpage>340</lpage><pub-id pub-id-type="doi">10.1016/j.jpowsour.2016.10.064</pub-id></element-citation></ref><ref id="CR16"><label>16.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Amodeo</surname><given-names>CM</given-names></name><name><surname>Ali</surname><given-names>MY</given-names></name><name><surname>Pan</surname><given-names>J</given-names></name></person-group><article-title>Computational models for simulations of lithium-ion battery modules under quasi-static and dynamic constrained compression tests</article-title><source>International Journal of Crashworthiness</source><year>2017</year><volume>22</volume><fpage>1</fpage><lpage>14</lpage><pub-id pub-id-type="doi">10.1080/13588265.2016.1213489</pub-id></element-citation></ref><ref id="CR17"><label>17.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xia</surname><given-names>Y</given-names></name><name><surname>Chen</surname><given-names>G</given-names></name><name><surname>Zhou</surname><given-names>Q</given-names></name><name><surname>Shi</surname><given-names>X</given-names></name><name><surname>Shi</surname><given-names>F</given-names></name></person-group><article-title>Failure behaviours of 100% soc lithium-ion battery modules under different impact loading conditions</article-title><source>Engineering Failure Analysis</source><year>2017</year><volume>82</volume><fpage>149</fpage><lpage>160</lpage><pub-id pub-id-type="doi">10.1016/j.engfailanal.2017.09.003</pub-id></element-citation></ref><ref id="CR18"><label>18.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xia</surname><given-names>Y</given-names></name><name><surname>Li</surname><given-names>T</given-names></name><name><surname>Ren</surname><given-names>F</given-names></name><name><surname>Gao</surname><given-names>Y</given-names></name><name><surname>Wang</surname><given-names>H</given-names></name></person-group><article-title>Failure analysis of pinch-torsion tests as a thermal runaway risk evaluation method of li-ion cells</article-title><source>Journal of Power Sources</source><year>2014</year><volume>265</volume><fpage>356</fpage><lpage>362</lpage><pub-id pub-id-type="doi">10.1016/j.jpowsour.2014.04.040</pub-id></element-citation></ref><ref id="CR19"><label>19.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xia</surname><given-names>Y</given-names></name><name><surname>Wierzbicki</surname><given-names>T</given-names></name><name><surname>Sahraei</surname><given-names>E</given-names></name><name><surname>Zhang</surname><given-names>X</given-names></name></person-group><article-title>Damage of cells and battery packs due to ground impact</article-title><source>Journal of Power Sources</source><year>2014</year><volume>267</volume><fpage>78</fpage><lpage>97</lpage><pub-id pub-id-type="doi">10.1016/j.jpowsour.2014.05.078</pub-id></element-citation></ref><ref id="CR20"><label>20.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marcicki</surname><given-names>J</given-names></name><name><surname>Yang</surname><given-names>XG</given-names></name><name><surname>Rairigh</surname><given-names>P</given-names></name></person-group><article-title>Fault current measurements during crush testing of electrically parallel lithium-ion battery modules</article-title><source>ECS Electrochemistry Letters</source><year>2015</year><volume>4</volume><fpage>A97</fpage><lpage>A99</lpage><pub-id pub-id-type="doi">10.1149/2.0011509eel</pub-id></element-citation></ref><ref id="CR21"><label>21.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Raffler</surname><given-names>M</given-names></name><etal/></person-group><article-title>Finite element model approach of a cylindrical lithium ion battery cell with a focus on minimization of the computational effort and short circuit prediction</article-title><source>Journal of Power Sources</source><year>2017</year><volume>360</volume><fpage>605</fpage><lpage>617</lpage><pub-id pub-id-type="doi">10.1016/j.jpowsour.2017.06.028</pub-id></element-citation></ref><ref id="CR22"><label>22.</label><mixed-citation publication-type="other">KermaniG.SahraeiE.Characterization and modeling of the mechanical properties of lithium-ion batteriesEnergies1017302017</mixed-citation></ref><ref id="CR23"><label>23.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sheikh</surname><given-names>M</given-names></name><name><surname>Elmarakbi</surname><given-names>A</given-names></name><name><surname>Elkady</surname><given-names>M</given-names></name></person-group><article-title>Thermal runaway detection of cylindrical 18650 lithium-ion battery under quasi-static loading conditions</article-title><source>Journal of Power Sources</source><year>2017</year><volume>370</volume><fpage>61</fpage><lpage>70</lpage><pub-id pub-id-type="doi">10.1016/j.jpowsour.2017.10.013</pub-id></element-citation></ref><ref id="CR24"><label>24.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jiang</surname><given-names>X</given-names></name><name><surname>Luo</surname><given-names>H</given-names></name><name><surname>Xia</surname><given-names>Y</given-names></name><name><surname>Zhou</surname><given-names>Q</given-names></name></person-group><article-title>Mechanical behavior of lithium-ion battery component materials and error sources analysis for test results</article-title><source>SAE International Journal of Materials and Manufacturing</source><year>2016</year><volume>9</volume><fpage>614</fpage><lpage>621</lpage><pub-id pub-id-type="doi">10.4271/2016-01-0400</pub-id></element-citation></ref><ref id="CR25"><label>25.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>C</given-names></name><name><surname>Xu</surname><given-names>J</given-names></name><name><surname>Cao</surname><given-names>L</given-names></name><name><surname>Wu</surname><given-names>Z</given-names></name><name><surname>Santhanagopalan</surname><given-names>S</given-names></name></person-group><article-title>Constitutive behavior and progressive mechanical failure of electrodes in lithium-ion batteries</article-title><source>Journal of Power Sources</source><year>2017</year><volume>357</volume><fpage>126</fpage><lpage>137</lpage><pub-id pub-id-type="doi">10.1016/j.jpowsour.2017.04.103</pub-id></element-citation></ref><ref id="CR26"><label>26.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sahraei</surname><given-names>E</given-names></name><name><surname>Kahn</surname><given-names>M</given-names></name><name><surname>Meier</surname><given-names>J</given-names></name><name><surname>Wierzbicki</surname><given-names>T</given-names></name></person-group><article-title>Modelling of cracks developed in lithium-ion cells under mechanical loading</article-title><source>Rsc Advances</source><year>2015</year><volume>5</volume><fpage>80369</fpage><lpage>80380</lpage><pub-id pub-id-type="doi">10.1039/C5RA17865G</pub-id></element-citation></ref><ref id="CR27"><label>27.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>X</given-names></name><name><surname>Sahraei</surname><given-names>E</given-names></name><name><surname>Wang</surname><given-names>K</given-names></name></person-group><article-title>Deformation and failure characteristics of four types of lithium-ion battery separators</article-title><source>Journal of Power Sources</source><year>2016</year><volume>327</volume><fpage>693</fpage><lpage>701</lpage><pub-id pub-id-type="doi">10.1016/j.jpowsour.2016.07.078</pub-id></element-citation></ref><ref id="CR28"><label>28.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lai</surname><given-names>W-J</given-names></name><name><surname>Ali</surname><given-names>MY</given-names></name><name><surname>Pan</surname><given-names>J</given-names></name></person-group><article-title>Mechanical behavior of representative volume elements of lithium-ion battery cells under compressive loading conditions</article-title><source>Journal of Power Sources</source><year>2014</year><volume>245</volume><fpage>609</fpage><lpage>623</lpage><pub-id pub-id-type="doi">10.1016/j.jpowsour.2013.06.134</pub-id></element-citation></ref><ref id="CR29"><label>29.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Volck</surname><given-names>T</given-names></name><etal/></person-group><article-title>Method for determination of the internal short resistance and heat evolution at different mechanical loads of a lithium ion battery cell based on dummy pouch cells</article-title><source>Batteries</source><year>2016</year><volume>2</volume><fpage>8</fpage><pub-id pub-id-type="doi">10.3390/batteries2020008</pub-id></element-citation></ref><ref id="CR30"><label>30.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feng</surname><given-names>X</given-names></name><name><surname>Pan</surname><given-names>Y</given-names></name><name><surname>He</surname><given-names>X</given-names></name><name><surname>Wang</surname><given-names>L</given-names></name><name><surname>Ouyang</surname><given-names>M</given-names></name></person-group><article-title>Detecting the internal short circuit in large-format lithium-ion battery using model-based fault-diagnosis algorithm</article-title><source>Journal of Energy Storage</source><year>2018</year><volume>18</volume><fpage>26</fpage><lpage>39</lpage><pub-id pub-id-type="doi">10.1016/j.est.2018.04.020</pub-id></element-citation></ref><ref id="CR31"><label>31.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feng</surname><given-names>X</given-names></name><name><surname>He</surname><given-names>X</given-names></name><name><surname>Lu</surname><given-names>L</given-names></name><name><surname>Ouyang</surname><given-names>M</given-names></name></person-group><article-title>Analysis on the fault features for internal short circuit detection using an electrochemical-thermal coupled model</article-title><source>Journal of The Electrochemical Society</source><year>2018</year><volume>165</volume><fpage>A155</fpage><lpage>A167</lpage><pub-id pub-id-type="doi">10.1149/2.0501802jes</pub-id></element-citation></ref><ref id="CR32"><label>32.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guo</surname><given-names>R</given-names></name><name><surname>Lu</surname><given-names>L</given-names></name><name><surname>Ouyang</surname><given-names>M</given-names></name><name><surname>Feng</surname><given-names>X</given-names></name></person-group><article-title>Mechanism of the entire overdischarge process and overdischarge-induced internal short circuit in lithium-ion batteries</article-title><source>Scientific reports</source><year>2016</year><volume>6</volume><fpage>30248</fpage><pub-id pub-id-type="doi">10.1038/srep30248</pub-id><?supplied-pmid 27444934?><pub-id pub-id-type="pmid">27444934</pub-id></element-citation></ref><ref id="CR33"><label>33.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cabrera-Castillo</surname><given-names>E</given-names></name><name><surname>Niedermeier</surname><given-names>F</given-names></name><name><surname>Jossen</surname><given-names>A</given-names></name></person-group><article-title>Calculation of the state of safety (sos) for lithium ion batteries</article-title><source>Journal of Power Sources</source><year>2016</year><volume>324</volume><fpage>509</fpage><lpage>520</lpage><pub-id pub-id-type="doi">10.1016/j.jpowsour.2016.05.068</pub-id></element-citation></ref><ref id="CR34"><label>34.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xia</surname><given-names>B</given-names></name><name><surname>Shang</surname><given-names>Y</given-names></name><name><surname>Nguyen</surname><given-names>T</given-names></name><name><surname>Mi</surname><given-names>C</given-names></name></person-group><article-title>A correlation based fault detection method for short circuits in battery packs</article-title><source>Journal of Power Sources</source><year>2017</year><volume>337</volume><fpage>1</fpage><lpage>10</lpage><pub-id pub-id-type="doi">10.1016/j.jpowsour.2016.11.007</pub-id></element-citation></ref><ref id="CR35"><label>35.</label><mixed-citation publication-type="other">Xia,&#x000a0; B.,&#x000a0; Shang,&#x000a0; Y.,&#x000a0; Nguyen,&#x000a0; T.&#x000a0;&#x00026;&#x000a0; Mi,&#x000a0; C.&#x000a0; External short circuit fault diagnosis based on supervised statistical learning. In <italic>Transportation Electrification Asia-Pacific (ITEC Asia-Pacific), 2017 IEEE Conference and Exp</italic>., 1&#x02013;5 (IEEE, 2017).</mixed-citation></ref><ref id="CR36"><label>36.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sidhu</surname><given-names>A</given-names></name><name><surname>Izadian</surname><given-names>A</given-names></name><name><surname>Anwar</surname><given-names>S</given-names></name></person-group><article-title>Adaptive nonlinear model-based fault diagnosis of li-ion batteries</article-title><source>IEEE Transactions on Industrial Electronics</source><year>2015</year><volume>62</volume><fpage>1002</fpage><lpage>1011</lpage><pub-id pub-id-type="doi">10.1109/TIE.2014.2336599</pub-id></element-citation></ref><ref id="CR37"><label>37.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>W</given-names></name><name><surname>Chen</surname><given-names>W-T</given-names></name><name><surname>Saif</surname><given-names>M</given-names></name><name><surname>Li</surname><given-names>M-F</given-names></name><name><surname>Wu</surname><given-names>H</given-names></name></person-group><article-title>Simultaneous fault isolation and estimation of lithium-ion batteries via synthesized design of luenberger and learning observers</article-title><source>IEEE Transactions on Control Systems Technology</source><year>2014</year><volume>22</volume><fpage>290</fpage><lpage>298</lpage><pub-id pub-id-type="doi">10.1109/TCST.2013.2239296</pub-id></element-citation></ref><ref id="CR38"><label>38.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ouyang</surname><given-names>M</given-names></name><etal/></person-group><article-title>Internal short circuit detection for battery pack using equivalent parameter and consistency method</article-title><source>Journal of Power Sources</source><year>2015</year><volume>294</volume><fpage>272</fpage><lpage>283</lpage><pub-id pub-id-type="doi">10.1016/j.jpowsour.2015.06.087</pub-id></element-citation></ref><ref id="CR39"><label>39.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seo</surname><given-names>M</given-names></name><name><surname>Goh</surname><given-names>T</given-names></name><name><surname>Park</surname><given-names>M</given-names></name><name><surname>Koo</surname><given-names>G</given-names></name><name><surname>Kim</surname><given-names>SW</given-names></name></person-group><article-title>Detection of internal short circuit in lithium ion battery using model-based switching model method</article-title><source>Energies</source><year>2017</year><volume>10</volume><fpage>76</fpage><pub-id pub-id-type="doi">10.3390/en10010076</pub-id></element-citation></ref><ref id="CR40"><label>40.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feng</surname><given-names>X</given-names></name><name><surname>Weng</surname><given-names>C</given-names></name><name><surname>Ouyang</surname><given-names>M</given-names></name><name><surname>Sun</surname><given-names>J</given-names></name></person-group><article-title>Online internal short circuit detection for a large format lithium ion battery</article-title><source>Applied Energy</source><year>2016</year><volume>161</volume><fpage>168</fpage><lpage>180</lpage><pub-id pub-id-type="doi">10.1016/j.apenergy.2015.10.019</pub-id></element-citation></ref><ref id="CR41"><label>41.</label><mixed-citation publication-type="other">Xia,&#x000a0; B.,&#x000a0; Mi,&#x000a0; C.,&#x000a0; Chen,&#x000a0; Z.&#x000a0;&#x00026;&#x000a0; Robert,&#x000a0; B.&#x000a0; Multiple cell lithium-ion battery system electric fault online diagnostics. In <italic>Transportation Electrification Conference and Expo (ITEC), 2015 IEEE</italic>, 1&#x02013;7 (IEEE, 2015).</mixed-citation></ref><ref id="CR42"><label>42.</label><mixed-citation publication-type="other">Asakura,&#x000a0; J.,&#x000a0; Nakashima,&#x000a0; T.,&#x000a0; Nakatsuji,&#x000a0; T.&#x000a0;&#x00026;&#x000a0; Fujikawa,&#x000a0; M.&#x000a0; Battery internal short-circuit detecting device and method, battery pack, and electronic device system (2008). US Patent App. 12/670,796.</mixed-citation></ref><ref id="CR43"><label>43.</label><mixed-citation publication-type="other">Yokotani,&#x000a0; K.&#x000a0; Battery system and method for detecting internal short circuit in battery system (2014). US Patent 8,643,332.</mixed-citation></ref><ref id="CR44"><label>44.</label><mixed-citation publication-type="other">Leidich,&#x000a0; S.,&#x000a0; Schumann,&#x000a0; S.&#x000a0;&#x00026;&#x000a0; Henrici,&#x000a0; F.&#x000a0; Method for detecting anomalies in a battery cell, and short-circuit sensor system (2015). US Patent App. 15/126,605.</mixed-citation></ref><ref id="CR45"><label>45.</label><mixed-citation publication-type="other">Asakura,&#x000a0; J.,&#x000a0; Nakashima,&#x000a0; T.,&#x000a0; Nakatsuji,&#x000a0; T.&#x000a0;&#x00026;&#x000a0; Fujikawa,&#x000a0; M.&#x000a0; Battery internal short-circuit detection apparatus and method, and battery pack (2012). US Patent 8,334,699.</mixed-citation></ref><ref id="CR46"><label>46.</label><mixed-citation publication-type="other">Hermann,&#x000a0; W.A.&#x000a0;&#x00026;&#x000a0; Kohn,&#x000a0; S.I.&#x000a0; Detection of over-current shorts in a battery pack using pattern recognition (2013). US Patent 8,618,775.</mixed-citation></ref><ref id="CR47"><label>47.</label><mixed-citation publication-type="other">Hermann,&#x000a0; W.A.&#x000a0;&#x00026;&#x000a0; Kohn,&#x000a0; S.I.&#x000a0; Detection of over-current in a battery pack (2013). US Patent App. 14/089,702.</mixed-citation></ref><ref id="CR48"><label>48.</label><mixed-citation publication-type="other">Dietterich,&#x000a0; T.G.&#x000a0; Ensemble methods in machine learning. In <italic>International workshop on multiple classifier systems</italic>, 1&#x02013;15 (Springer, 2000).</mixed-citation></ref><ref id="CR49"><label>49.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Duro</surname><given-names>DC</given-names></name><name><surname>Franklin</surname><given-names>SE</given-names></name><name><surname>Dub&#x000e9;</surname><given-names>MG</given-names></name></person-group><article-title>Multi-scale object-based image analysis and feature selection of multi-sensor earth observation imagery using random forests</article-title><source>International Journal of Remote Sensing</source><year>2012</year><volume>33</volume><fpage>4502</fpage><lpage>4526</lpage><pub-id pub-id-type="doi">10.1080/01431161.2011.649864</pub-id></element-citation></ref><ref id="CR50"><label>50.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Breiman</surname><given-names>L</given-names></name></person-group><article-title>Random forests</article-title><source>Machine learning</source><year>2001</year><volume>45</volume><fpage>5</fpage><lpage>32</lpage><pub-id pub-id-type="doi">10.1023/A:1010933404324</pub-id></element-citation></ref><ref id="CR51"><label>51.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Memar</surname><given-names>P</given-names></name><name><surname>Faradji</surname><given-names>F</given-names></name></person-group><article-title>A novel multi-class eeg-based sleep stage classification system</article-title><source>IEEE Transactions on Neural Systems and Rehabilitation Engineering</source><year>2018</year><volume>26</volume><fpage>84</fpage><lpage>95</lpage><pub-id pub-id-type="doi">10.1109/TNSRE.2017.2776149</pub-id><?supplied-pmid 29324406?><pub-id pub-id-type="pmid">29324406</pub-id></element-citation></ref><ref id="CR52"><label>52.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Z</given-names></name><etal/></person-group><article-title>Fault diagnosis of a rolling bearing using wavelet packet denoising and random forests</article-title><source>IEEE Sensors Journal</source><year>2017</year><volume>17</volume><fpage>5581</fpage><lpage>5588</lpage><pub-id pub-id-type="doi">10.1109/JSEN.2017.2726011</pub-id></element-citation></ref><ref id="CR53"><label>53.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>ElMeguid</surname><given-names>MKA</given-names></name><name><surname>Levine</surname><given-names>MD</given-names></name></person-group><article-title>Fully automated recognition of spontaneous facial expressions in videos using random forest classifiers</article-title><source>IEEE Transactions on Affective Computing</source><year>2014</year><volume>5</volume><fpage>141</fpage><lpage>154</lpage><pub-id pub-id-type="doi">10.1109/TAFFC.2014.2317711</pub-id></element-citation></ref><ref id="CR54"><label>54.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>H</given-names></name><etal/></person-group><article-title>Image classification using rapideye data: Integration of spectral and textual features in a random forest classifier</article-title><source>IEEE Journal of Selected Topics in Applied Earth Observations and Remote Sensing</source><year>2017</year><volume>10</volume><fpage>5334</fpage><lpage>5349</lpage><pub-id pub-id-type="doi">10.1109/JSTARS.2017.2774807</pub-id></element-citation></ref><ref id="CR55"><label>55.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>B</given-names></name><name><surname>Cao</surname><given-names>Z</given-names></name><name><surname>Wang</surname><given-names>S</given-names></name></person-group><article-title>Lung vessel segmentation based on random forests</article-title><source>Electronics Letters</source><year>2017</year><volume>53</volume><fpage>220</fpage><lpage>222</lpage><pub-id pub-id-type="doi">10.1049/el.2016.4438</pub-id></element-citation></ref><ref id="CR56"><label>56.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ouyang</surname><given-names>M</given-names></name><etal/></person-group><article-title>Internal short circuit detection for battery pack using equivalent parameter and consistency method</article-title><source>Journal of Power Sources</source><year>2015</year><volume>294</volume><fpage>272</fpage><lpage>283</lpage><pub-id pub-id-type="doi">10.1016/j.jpowsour.2015.06.087</pub-id></element-citation></ref><ref id="CR57"><label>57.</label><mixed-citation publication-type="other">Xia,&#x000a0; B.,&#x000a0; Mi,&#x000a0; C.,&#x000a0; Chen,&#x000a0; Z.&#x000a0;&#x00026;&#x000a0; Robert,&#x000a0; B.&#x000a0; Multiple cell lithium-ion battery system electric fault online diagnostics. In <italic>Transportation Electrification Conference and Expo (ITEC), 2015 IEEE</italic>, 1&#x02013;7 (IEEE, 2015).</mixed-citation></ref><ref id="CR58"><label>58.</label><mixed-citation publication-type="other">Keates,&#x000a0; A.W.,&#x000a0; Otani,&#x000a0; N.,&#x000a0; Nguyen,&#x000a0; D.J.,&#x000a0; Matsumura,&#x000a0; N.&#x000a0;&#x00026;&#x000a0; Li,&#x000a0; P.T.&#x000a0; Short circuit detection for batteries (2010). US Patent 7,795,843.</mixed-citation></ref><ref id="CR59"><label>59.</label><mixed-citation publication-type="other">Love,&#x000a0; C.T.&#x000a0;&#x00026;&#x000a0; Swider-Lyons,&#x000a0; K.&#x000a0; Battery health monitoring system and method (2016). US Patent 9,465,077.</mixed-citation></ref><ref id="CR60"><label>60.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hu</surname><given-names>X</given-names></name><name><surname>Li</surname><given-names>S</given-names></name><name><surname>Peng</surname><given-names>H</given-names></name></person-group><article-title>A comparative study of equivalent circuit models for li-ion batteries</article-title><source>Journal of Power Sources</source><year>2012</year><volume>198</volume><fpage>359</fpage><lpage>367</lpage><pub-id pub-id-type="doi">10.1016/j.jpowsour.2011.10.013</pub-id></element-citation></ref><ref id="CR61"><label>61.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>K</given-names></name><name><surname>Zou</surname><given-names>C</given-names></name><name><surname>Li</surname><given-names>K</given-names></name><name><surname>Wik</surname><given-names>T</given-names></name></person-group><article-title>Charging pattern optimization for lithium-ion batteries with an electrothermal-aging model</article-title><source>IEEE Transactions on Industrial Informatics</source><year>2018</year><volume>14</volume><fpage>5463</fpage><lpage>5474</lpage><pub-id pub-id-type="doi">10.1109/TII.2018.2866493</pub-id></element-citation></ref><ref id="CR62"><label>62.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>K</given-names></name><name><surname>Hu</surname><given-names>X</given-names></name><name><surname>Yang</surname><given-names>Z</given-names></name><name><surname>Xie</surname><given-names>Y</given-names></name><name><surname>Feng</surname><given-names>S</given-names></name></person-group><article-title>Lithium-ion battery charging management considering economic costs of electrical energy loss and battery degradation</article-title><source>Energy Conversion and Management</source><year>2019</year><volume>195</volume><fpage>167</fpage><lpage>179</lpage><pub-id pub-id-type="doi">10.1016/j.enconman.2019.04.065</pub-id></element-citation></ref><ref id="CR63"><label>63.</label><mixed-citation publication-type="other">M&#x000fc;ller,&#x000a0; A.C.&#x000a0;&#x00026;&#x000a0; Guido,&#x000a0; S.&#x000a0; <italic>Introduction to machine learning with Python: a guide for data scientists</italic> ("O&#x02019;Reilly Media, Inc.&#x0201d;, 2016).</mixed-citation></ref></ref-list></back></article>